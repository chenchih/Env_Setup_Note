# Detects terminal via $TERM_PROGRAM (Warp, iTerm, Terminal with switch prompt type
# - Warp → Starship (reads ~/.config/starship.toml)
# - iTerm2 & Apple Terminal → Powerlevel10k (uses ~/.p10k.zsh)


case "$TERM_PROGRAM" in

  # Warp → Starship (no need to re-load OMZ/plugins)
  WarpTerminal|Warp.app)
    export STARSHIP_CONFIG="$HOME/.config/starship.toml"
    eval "$(starship init zsh)"
    ;;

  # Everything else (iTerm2, Apple Terminal, etc.) → Powerlevel10k
  *)
    # 1. Instant prompt (must be early)
    if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
      source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
    fi

    # 2. Oh My Zsh core + plugins
    export ZSH="$HOME/.oh-my-zsh"
    plugins=(git zsh-autosuggestions zsh-syntax-highlighting zsh-z web-search)
    source "$ZSH/oh-my-zsh.sh"

    # 3. Powerlevel10k theme
    source "${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/powerlevel10k/powerlevel10k.zsh-theme"
    [[ -f ~/.p10k.zsh ]] && source ~/.p10k.zsh
    ;;
esac


[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh
HISTFILE=~/.zsh_history
HISTSIZE=5000
SAVEHIST=$HISTSIZE
setopt APPEND_HISTORY     
setopt SHARE_HISTORY      
setopt HIST_IGNORE_DUPS   
setopt HIST_IGNORE_SPACE    
setopt HIST_IGNORE_ALL_DUPS
export FZF_DEFAULT_OPTS='--reverse --border --exact --height=50%'
