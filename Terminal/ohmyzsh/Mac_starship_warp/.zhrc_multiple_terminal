# Detect terminal and load the right prompt:
# • Warp            → Starship (no Oh-My-Zsh needed)
# • iTerm2          → Powerlevel10k + Oh-My-Zsh plugins
# • Apple Terminal  → Manual pick inside the `*)` branch:
#                     A) plain zsh (no OMZ/P10K), or
#                     B) OMZ with a normal theme (e.g., agnoster), or
#                     C) Powerlevel10k
export ZSH="$HOME/.oh-my-zsh"
plugins=(git zsh-autosuggestions zsh-syntax-highlighting zsh-z web-search)

case "$TERM_PROGRAM" in
  # Warp → Starship
  WarpTerminal|Warp.app)
    export STARSHIP_CONFIG="$HOME/.config/starship.toml"
    eval "$(starship init zsh)"
    ;;

  # iTerm2 → Powerlevel10k
  iTerm.app)
    # P10K instant prompt (must be early)
    if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
      source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
    fi
    export ZSH="$HOME/.oh-my-zsh"
    ZSH_THEME=""
    #plugins=(git zsh-autosuggestions zsh-syntax-highlighting zsh-z web-search)
    source "$ZSH/oh-my-zsh.sh"
    source "${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/powerlevel10k/powerlevel10k.zsh-theme"
    [[ -f ~/.p10k.zsh ]] && source ~/.p10k.zsh
    ;;

  # Apple Terminal (and any other terminal) → pick ONE of A/B/C by uncommenting
  *)


    ##### loads Oh-My-Zsh ######
    #export ZSH="$HOME/.oh-my-zsh"
    #ZSH_THEME="agnoster"   # change to robbyrussell / avit / bira / etc.
    #plugins=(git zsh-autosuggestions zsh-syntax-highlighting zsh-z web-search)
    #source "$ZSH/oh-my-zsh.sh"

    ##### Powerlevel10k (disable above) #####
    # if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
    #   source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
    # fi
    # export ZSH="$HOME/.oh-my-zsh"
    # ZSH_THEME=""
    # plugins=(git zsh-autosuggestions zsh-syntax-highlighting zsh-z web-search)
    # source "$ZSH/oh-my-zsh.sh"
    # source "${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/powerlevel10k/powerlevel10k.zsh-theme"
    # [[ -f ~/.p10k.zsh ]] && source ~/.p10k.zsh
    ;;
esac


[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh
HISTFILE=~/.zsh_history
HISTSIZE=5000
SAVEHIST=$HISTSIZE
setopt APPEND_HISTORY     
setopt SHARE_HISTORY      
setopt HIST_IGNORE_DUPS   
setopt HIST_IGNORE_SPACE    
setopt HIST_IGNORE_ALL_DUPS
export FZF_DEFAULT_OPTS='--reverse --border --exact --height=50%'

